# Idiom of the Day - Original Specification

This document contains the original prompt/specification used to build this app.

---

You are an expert TypeScript/HTML/CSS engineer.
Your task is to implement MVP1 of a web app that helps a user learn one new idiom per day, and occasionally take small quizzes before unlocking additional idioms.

Use TypeScript + vanilla HTML + vanilla CSS only.
Design the architecture to allow easy future migration to frameworks like React/Svelte/Astro, and potential future cloud sync.
Focus on clean separation of concerns, modular TypeScript, and minimal DOM-manipulation helpers.

## üß± 1. Tech Stack Requirements

- TypeScript, compiled to JS (use modules).
- HTML + CSS, no frameworks.
- No server-side logic; everything runs client-side.
- Idioms come from a static JSON file bundled with the app.
- Persist all user data in localStorage.
- Structure TS so that later it can be ported to a framework without major rewrite (e.g., state store + render functions).

## üìò 2. Idiom-of-the-Day Logic

### Daily Idiom Behavior

- On first visit of a given local calendar day, the app automatically shows one new idiom.
- All idioms viewed on that date (through "Next Idiom") become the "idioms of that day."
- When revisiting the app later the same day:
  - Show all idioms for that day in a list or carousel.
  - Highlight idioms with a small label: "Idiom of the Day".

### Device Date Rules

- Use user's local device date without trying to detect manipulation.
- If the user moves clock forward to a future date:
  - Treat it as a new day.
  - Assign a new idiom for that date.
- If the user moves clock backward to a past date:
  - If idioms exist for that date ‚Üí show them.
  - If no idioms exist for that date ‚Üí immediately assign a new idiom for that date (retroactively), exactly as if visiting that date for the first time.

## üìò 3. "Next Idiom" Button Rules

- Always available (except during quizzes).
- Quiz the user (see 5 - quiz rules)

## üß© 4. Learning vs Seen

- An idiom becomes "seen" the moment it is displayed.
- An idiom becomes "learned" only when the user passes a quiz on it.

## üìù 5. Quiz Rules (MVP1)

### When is a quiz required?

Required whenever the user clicks "Next Idiom".

### Quiz pool
All previously seen idioms (learned or not) contribute to the quiz pool.
But choose them in this order of priority:

Idioms that have been seen but not yet learned.
Followed by Idioms that have been seen.

### Quiz Format (MVP1)

- Multiple-choice only for MVP1.
- Each question has 4 options.
- Correct answer = meaning of the idiom.
- Wrong answers = definitions of other idioms the user has seen or learned and if they are not enough to create the wrong option, use as yet un-seen definitions.

### Additional Quiz Types (Post-MVP1)

All quiz types must work offline using only the local idiom JSON file. No external APIs required.

#### 1. Reverse Multiple-Choice (Definition ‚Üí Idiom)

**Description:**
Show a definition and four idioms; the user selects the idiom that matches the definition.

**Rules:**
- Correct answer = idiom being quizzed.
- Distractors = 3 idioms chosen randomly from the user's seen idioms.
- Avoid distractors with identical meanings.
- UI identical to standard MCQ.

#### 2. Cloze (Fill-in-the-Blank) Using Example Sentences

**Description:**
Pull an example sentence from the JSON file and hide the idiom text.

**Rules:**
- Replace the idiom in the example sentence with a blank ("____").
- Answer is the idiom text.
- Provide either text input or 4-option multiple-choice (developer's choice).
- If multiple-choice: distractor idioms chosen at random.

#### 3. Correct Usage Identification

**Description:**
Show 3‚Äì4 sentences; only one uses the idiom correctly.

**Rules:**
- Correct sentence = use the idiom's example sentence from the JSON file.
- Incorrect sentences = generated by simple templating:
  - Replace the idiom with a different one, OR
  - Alter verb tense incorrectly, OR
  - Insert idiom in an illogical context.
- Keep generation deterministic and simple (no AI).

#### 4. True/False Questions

**Description:**
Show a short statement about the idiom; user decides if it is true or false.

**Rules:**
- True statements = factual definitions or simplified rewordings.
- False statements = swap meanings with another idiom or create harmless distortions.
- Keep sentences short and unambiguous.
- 50% true, 50% false when randomly generating sessions.

#### 5. Word-Order Sequencing (Reorder the Idiom)

**Description:**
Split the idiom into individual words (or tokens); shuffle them.
User drags/drops or clicks in order to reconstruct the idiom.

**Rules:**
- Only works on idioms with ‚â•2 words.
- Shuffle deterministically but avoid presenting it already in correct order.
- Accept only the exact correct ordering.
- Keep punctuation (if any) in the tokens.

### Quiz Size

- Ask a random number of questions capped at 5 questions. So questions 0 < {random number} <= 5  
  - Prefer previously un-quizzed questions first.
  - As a secondary preference, use older-learned idioms if needed.

### Pass/Fail

- ‚â• 70% correct ‚Üí pass.
- < 70% ‚Üí fail.

### Failure behavior

- User must retry until they pass.
- Unlimited attempts.
- Cannot unlock next idiom until they pass.

### Quiz UI

- Full-screen modal overlay that blocks all interaction.
- If refresh happens:
  - If they have not submitted the first question ‚Üí quiz resets (treated as never started).
  - If future features need restoring state, the data model should support it.

## üì¶ 6. Data Model Requirements

Use localStorage with a small abstraction layer.
Store data in a way that supports future cloud sync but keeps implementation local.

Store:

### 6.1 Idiom Metadata

Full idiom text stays in the bundled JSON.
Store only metadata:

```json
{
  "idiomId": "string",
  "dateSeen": "string (YYYY-MM-DD)",
  "dateLearned": "string (optional)",
  "quizHistory": [
    {
      "timestamp": "number",
      "score": "number",
      "numQuestions": "number"
    }
  ]
}
```

### 6.2 Daily Logs

Quick lookup for idioms per date:

```json
{
  "daily": {
    "YYYY-MM-DD": {
      "seen": ["string[]"],
      "learned": ["string[]"]
    }
  }
}
```

### 6.3 Quiz State (for future use)

```json
{
  "quizInProgress": {
    "idiomIds": ["string[]"],
    "currentIndex": "number",
    "answers": ["(string | null)[]"]
  }
}
```

### 6.4 Current Idiom Index

Which idiom from the JSON file to show next.

## üóÇ 7. Idiom Dataset Rules

- Use a local static JSON file.
- Randomize order before bundling.
- Each idiom object contains:
  - `"id"`
  - `"idiom"` (text)
  - `"definition"` (full Wiktionary definition allowed)
  - `"examples"` (array)

### ‚úÖ Sample JSON File to Bundle (idioms.json)

```json
[
  {
    "id": "idiom_001",
    "idiom": "break the ice",
    "definition": "To overcome initial social awkwardness; to relieve tension and get conversation going.",
    "examples": [
      "He told a joke to break the ice at the meeting.",
      "A fun activity can help break the ice on the first day of class."
    ]
  },
  {
    "id": "idiom_002",
    "idiom": "hit the nail on the head",
    "definition": "To describe a situation or problem very accurately.",
    "examples": [
      "When she said the project failed because of poor planning, she hit the nail on the head."
    ]
  },
  {
    "id": "idiom_003",
    "idiom": "once in a blue moon",
    "definition": "Very rarely; something that does not happen often.",
    "examples": [
      "We only get together once in a blue moon these days."
    ]
  },
  {
    "id": "idiom_004",
    "idiom": "spill the beans",
    "definition": "To reveal a secret or disclose something confidential.",
    "examples": [
      "Don't spill the beans about the surprise party!"
    ]
  },
  {
    "id": "idiom_005",
    "idiom": "under the weather",
    "definition": "Feeling ill or slightly sick.",
    "examples": [
      "I stayed home today because I was feeling under the weather."
    ]
  }
]
```

This is only a sample. The final dataset can include hundreds of idioms.

## üé® 8. UI Requirements

### Core screens

**Home Screen**
- Show today's idioms (list or carousel)
- Label: "Idiom of the Day"
- "Next Idiom" button

**Quiz Screen (Modal)**
- 4-option MCQs
- Progress indicator
- Block progression until quiz is passed

**Quiz Summary**
- Score out of total
- Brief encouraging message
- Then reveal new idiom

## üîß 9. Engineering Architecture Requirements

### State Management

Create a TypeScript store that encapsulates:
- Idiom-of-the-day logic
- Date logic
- Quiz generation
- Metadata persistence
- Utility getters

### Rendering

- Use functions like `renderHomeScreen()` and `renderQuizModal()`.
- No frameworks or JSX.
- Keep UI logic thin.

### CSS

- Simple BEM-like classes.
- A few CSS variables.
- No frameworks.

## üîÆ 10. Future Expandability

Design the architecture so it can later support:
- Other quiz types (typed answers, flashcards)
- User proficiency modeling
- Cloud sync + login
- History browsing
- Daily email delivery
- Search & filters

Store design must not block these.

---

*End of Specification*